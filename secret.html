<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Chatbot</title>
    <style>
        /* Your styles here... */
        #chatbox {
            /* Add any specific styles for the chatbox container here */
        }

        .message {
            margin-bottom: 10px;
        }

        .user-message {
            color: blue; /* Style for user messages */
        }

        .bot-message {
            color: green; /* Style for bot messages */
        }
    </style>
</head>
<body>
    <div id="chatbox"></div>
    <div id="input-container">
        <input type="text" id="user-input" placeholder="Type your message...">
        <button id="send-button" onclick="sendMessage()">Send</button>
    </div>

    <script>
        const chatbox = document.getElementById('chatbox');
        const userInput = document.getElementById('user-input');

        function sendMessage() {
            const userMessage = userInput.value.trim();
            if (userMessage) {
                appendMessage('User', userMessage, 'user-message');
                handleBotResponse(userMessage);
                userInput.value = '';
            }
        }

        function appendMessage(sender, message, messageClass) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', messageClass);
            messageDiv.innerHTML = `<strong>${sender}:</strong> ${message}`;
            chatbox.appendChild(messageDiv);
            chatbox.scrollTop = chatbox.scrollHeight; // Auto-scroll to the bottom
        }

        function fetchAnswersFromGoogle(query) {
            const googleApiKey = 'AIzaSyDPVqP6l-NdTAJ1Zg5oKFiLORz-M5tDZvE';
            const googleEngineId = 'e66093057c55d4a1d';

            axios.get(`https://www.googleapis.com/customsearch/v1?key=${googleApiKey}&cx=${googleEngineId}&q=${query}`)
                .then((response) => {
                    const searchResults = response.data.items;

                    if (searchResults && searchResults.length > 0) {
                        const topResult = searchResults[0];
                        const title = topResult.title;
                        const snippet = topResult.snippet;
                        const link = topResult.link;

                        const googleResponse = `${title}. Here's a snippet: ${snippet}<br><a href="${link}" target="_blank">Read more</a>`;
                        appendMessage("Bot", googleResponse, 'bot-message');
                    } else {
                        const noResultsResponse = "I couldn't find any relevant results.";
                        appendMessage("Bot", noResultsResponse, 'bot-message');
                    }
                })
                .catch((error) => {
                    console.error("Error fetching Google results:", error);
                    const errorMessage = "Sorry, I encountered an error while fetching results from Google.";
                    appendMessage("Bot", errorMessage, 'bot-message');
                });
        }

        function handleBotResponse(userMessage) {
            const lowerCaseMessage = userMessage.toLowerCase();

            // Q&A Logic
            if (lowerCaseMessage.includes('wake up neo')) {
                setTimeout(() => {
                    appendMessage('Bot', 'The Matrix has you...', 'bot-message');
                    setTimeout(() => {
                        appendMessage('Bot', 'Follow the white rabbit.', 'bot-message');
                    }, 1000);
                }, 1000);
            } else if (lowerCaseMessage.includes('who are you')) {
                appendMessage('Bot', 'I am just a simple chatbot.', 'bot-message');
            } else if (lowerCaseMessage.includes('what is the matrix')) {
                appendMessage('Bot', 'The Matrix is everywhere, Neo.', 'bot-message');
            } else if (lowerCaseMessage.includes('open app')) {
                const appName = lowerCaseMessage.split('open app')[1]?.trim();
                if (appName) {
                    openApp(appName);
                } else {
                    appendMessage('Bot', 'Please specify the app name.', 'bot-message');
                }
            } else if (lowerCaseMessage.includes('take photo')) {
                takePhoto();
            } else if (lowerCaseMessage.includes('google search')) {
                const searchQuery = lowerCaseMessage.split('google search')[1]?.trim();
                if (searchQuery) {
                    fetchAnswersFromGoogle(searchQuery);
                } else {
                    appendMessage('Bot', 'Please provide a search query.', 'bot-message');
                }
            } else {
                appendMessage('Bot', 'I did not understand that.', 'bot-message');
            }
        }

        function openApp(appName) {
            appendMessage('Bot', `Opening ${appName} app...`, 'bot-message');
            // In a real scenario, you would use appropriate APIs to open the app.
        }

        function takePhoto() {
            appendMessage('Bot', 'Taking a photo...', 'bot-message');
            // In a real scenario, you would use appropriate APIs to take and save a photo.
            appendMessage('Bot', 'Photo taken and saved.', 'bot-message');
        }
    </script>
</body>
</html>
